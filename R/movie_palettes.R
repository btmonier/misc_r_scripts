#------------------------------------------------------------------------------
# Title:         Movie Palettes
# Author:        Brandon Monier (brandon.monier@sdstate.edu)
# Created:       2018-06-04 21:21:22 CDT
# Last Modified: 2018-06-04 21:21:29 CDT
#------------------------------------------------------------------------------


movie_palettes <- list(
	the_shining = c(
		"#381D12", "#F89787", "#3C5D37", "#698A91", "#A33D15",
		"#564531", "#2D3743", "#A06F5E", "#5D0C08", "#0D0A03"
	),
	the_big_lebowski = c(
		"#6A6D76", "#71270E", "#272729", "#755347", "#9FA5E3",
		"#978E7F", "#455A5B", "#663E0D", "#825167", "#39394D"
	),
	star_wars_ep_v = c(
		"#3B241E", "#495B83", "#2A2432", "#F46249", "#87758D",
		"#849DB3", "#4D331A", "#E5BFA8", "#97AD96", "#1A1E3B"
	),
	the_godfather = c(
		"#1F191B", "#502A17", "#854C16", "#1C1B17", "#CFBF9D",
		"#BF2316", "#F0E7BC", "#EFAC58", "#B97F1B", "#4B3C1D"
	),
	the_revenant = c(
		"#161B1E", "#262E31", "#7F7C77", "#E8DFE0", "#B0B9C2",
		"#92AFC0", "#4E8BA8", "#103E55", "#0F3F54", "#020E17"
	),
	fargo = c(
		"#41494B", "#190A07", "#52382B", "#3C1414", "#FFBCCF",
		"#AA7B75", "#47423C", "#5C0806", "#E1ECFE", "#FE7A88"
	),
	the_professional = c(
		"#665E47", "#9D8B76", "#B4775B", "#AD3429", "#6B140B",
		"#B65D35", "#C19029", "#464E29", "#3D4753", "#040001"
	),
	akira = c(
		"#115363", "#9D3011", "#5C4356", "#7EA030", "#7E2835",
		"#756B2E", "#02182E", "#9E0402", "#1A3330", "#1F2549"
	),
	pulp_fiction = c(
		"#060408", "#BA8B5F", "#EBDAC0", "#710906", "#241206",
		"#4A403F", "#3E5BFF", "#280203", "#161908", "#343A36"
	),
	taxi_driver = c(
		"#271B1D", "#ABA5A7", "#5D474A", "#443A32", "#735D34",
		"#784542", "#857983", "#230D10", "#AB9392", "#5B6042"
	),
	a_clockwork_orange = c(
		"#D8C406", "#C28204", "#F95F33", "#DF2318", "#45161C",
		"#1D131B", "#23284E", "#2557D0", "#233C26", "#1A1C17"
	),
	ferris_buellers_day_off = c(
		"#775B4F", "#F7C7B9", "#D5D9FC", "#2F3744", "#8695AA",
		"#C4C3C8", "#4A5A67", "#0D0B10", "#817775", "#241A19"
	),
	fear_and_loathing_in_las_vegas = c(
		"#6F3F19", "#A68166", "#D2382E", "#FFDCC9", "#D79460",
		"#FFBE46", "#903F00", "#2F130F", "#5A5865", "#3E350C"
	),
	american_beauty = c(
		"#E2A9B2", "#AF6B84", "#77404C", "#4D222B", "#341211",
		"#2B0105", "#490102", "#7B0400", "#860315", "#B8133D"
	),
	blade_runner = c(
		"#6D3F42", "#946C86", "#654F7E", "#3C2E48", "#182132",
		"#223F6B", "#547FA2", "#94B4B3", "#69C0B8", "#216B64"
	),
	alien = c(
		"#0B3242", "#0A1A1A", "#000000", "#232E30", "#445766",
		"#AFBACC", "#D4D9DC", "#B7A29F", "#764B55", "#362722"
	),
	napoleon_dynamite = c(
		"#3E0D10", "#94635E", "#58619C", "#C19733", "#3E2123",
		"#9D3303", "#D1CDDC", "#4D3F3F", "#7C434A", "#0F040A"
	),
	edward_scissorhands = c(
		"#5D709B", "#B3897B", "#5F5D22", "#7C554E", "#F59886",
		"#E0C1B6", "#C67DB4", "#A9A96B", "#9692A0", "#F46E4B"
	),
	thelma_and_louise = c(
		"#333436", "#B57A9E", "#7C585A", "#9894BA", "#68151D",
		"#472C17", "#6D695E", "#CA927B", "#8898B1", "#5E7856"
	),
	fight_club = c(
		"#292B15", "#99D4E6", "#08171C", "#5B1714", "#A69B6E",
		"#F2BE37", "#C0B9E5", "#E0E0E2", "#30DDA7", "#010207"
	),
	the_truman_show = c(
		"#0E0B12", "#262431", "#575E70", "#A6A6B0", "#D7D1DB",
		"#BAC1D3", "#A0BAD5", "#859ED2", "#5477AD", "#142F61"
	),
	mad_max_fury_road = c(
		"#0D646B", "#16383A", "#414640", "#B88F73", "#FFD2B5",
		"#ED8F49", "#E27812", "#5C2A09", "#2E1612", "#0F1217"
	),
	resevoir_dogs = c(
		"#513F4F", "#4E1B0A", "#2C191D", "#9B5764", "#4B577D",
		"#5C373E", "#62090D", "#D8BCE2", "#19080E", "#A67D83"
	),
	blue_velvet = c(
		"#000103", "#120807", "#1E0606", "#3F0C11", "#5A050C",
		"#79022A", "#971E54", "#E15C9E", "#FDA9DD", "#F3BCC9"
	),
	silence_of_the_lambs = c(
		"#726554", "#371A16", "#A45D4A", "#C6BEBB", "#9A1E00",
		"#120D09", "#613613", "#80371E", "#DCB8A2", "#4C0D00"
	),
	the_matrix = c(
		"#060407", "#0B1013", "#841211", "#1E2E2D", "#344745",
		"#60807B", "#7D9A88", "#9DBEB3", "#C1D6C7", "#DCEEF2"
	)	
)

movie_palette <- function(name, n = NULL, type = c("discrete", "continuous")) {
	type <- match.arg(type)
	
	pal <- movie_palettes[[name]]
	if (is.null(pal)) {
		stop("This palette could not be found.")
	}

	if (is.null(n)) {
		n <- length(pal)
	} else if (type == "discrete" && n > length(pal)) {
		warning(
			paste0(
				"n too large, allowed maximum for palette ", 
				"\"", name, "\"", " is ", length(pal), ".\n",
				"Displaying the palette you asked for with that many colors.",
				"\n"
			)
		)
		n <- length(pal)
	}

	if (type == "discrete") {
		pal <- pal[seq_len(n)]
	} else if (type == "continuous") {
		pal <- grDevices::colorRampPalette(pal)(n)
	}

	structure(pal, class = "movie", name = name, type = type)
}


print.movie <- function(x, ...) {
	n <- length(x)
	old <- par(pty = "m", mar = c(3, 1, 3, 1))
	on.exit(par(old))

	image(
		x = 0:n, 
		y = c(0, 2.5), 
		z = as.matrix(1:n), 
		col = x,
		ylab = "",
		xlab = "", 
		xaxt = "n", 
		yaxt = "n", 
		bty = "n"
	)

	t_lab <- syntax(attr(x, "name"))
	b_lab <- paste("Colors:", n)

	rect(
		xleft = 0, 
		ybottom = 0, 
		xright = n, 
		ytop = 0.5, 
		col = rgb(1, 1, 1), 
		border = NA
	)

	rect(
		xleft = 0, 
		ybottom = 2, 
		xright = n, 
		ytop = 2.5, 
		col = rgb(1, 1, 1), 
		border = NA
	)	
	text(n * 0.5, 2.25, labels = t_lab, cex = 1, font = 2)
	text(n * 0.5, 0.25, labels = b_lab, cex = 1, font = 1)
}

summary.movie <- function(x, ...) {
	cat("La Croix, so tasty...\n")
	cat("  Class.....", class(x), "\n")
	cat("  Length....", length(x), "\n")
	cat("  Palette...", attr(x, "name"), "\n")
	cat("  Type......", attr(x, "type"), "\n")
}

movie_all <- function(...) {
	names <- names(movie_palettes)
	max_len <- 10
	oldpar <- par(mgp = c(2, 0.25, 0))
    on.exit(par(oldpar))

	plot(
		x = c(0, max_len),
		y = c(0, length(names)),
		type = "n",
		axes = FALSE,
		xlab = "",
		ylab = "",
		main = "All palettes"
	)

	for (i in seq_len(max_len)) {
		for (j in seq_along(names)) {
			rect(
				xleft = i - 1, 
				ybottom = j - 1, 
				xright = i, 
				ytop = j - 0.2, 
				col = movie_palette(names[j])[i], 
				border = "white",
				lwd = 5
			)	
		}
	}

	text(
		rep(-0.1, length(names)), 
		seq_along(names) - 0.6, 
		labels = names, 
		xpd = TRUE, 
		adj = 1
	)	
}